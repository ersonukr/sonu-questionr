<% if notice || alert %>
  <div class="alert alert-dismissible alert-<%=notice ? 'success' : 'danger'%> col-lg-12">
  	<button type="button" class="close" data-dismiss="alert">Ã—</button>
  	<%= notice || alert %>
  </div>
<% end %>

<div class="col-lg-12">
  <form method="get" action="search" class="col-lg-12">
	  <fieldset>
      <div class="col-lg-3">
        <input name="q" type="text" value="<%= params[:q] %>" class="form-control"/>
        <!-- <input name="e" type="text" value="<%= params[:e] %>" class="form-control"/> -->
      </div>
      <div class="col-lg-1">    
        <input type="submit" value="Search" class="btn btn-info"/>
      </div>
      <h3 class="col-lg-offset-6 col-lg-2"> Result(s): <span id="searchResult"></span></h3>
    </fieldset>
  </form>
</div>

<div class="col-lg-12" style="margin-top: 20px">
  <% if @statements.blank? %>
    <div class="warning">Sorry, We don't found any result.</div>
  <% else %>
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th>Candidate(s)</th>
          <th>Speaker(s)</th>
          <th>Event Name</th>
          <th>Location</th>
          <th>Public</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
      <% @statements.each do |statement| %>
        <% if search_filter(statement) %>
          <tr class="search_row">
            <td><%= link_to(statement.candidate.person_name, statement.candidate)%></td>
            <% statement.candidate.events.each do |event| %>
            <td><%= event.format_speakers %></td>
            <td><%= link_to event.title, event %></td>
            <td><%= event.format_location %></td>
            <td><%= event.public? ? 'Yes' : 'No' %></td>
            <% end %>
            <td><%= statement.event_day.date.strftime("%m/%d/%Y") if statement.event_day.present? %></td>
          </tr>
        <% end %>
      <% end %>
      </tbody>
    </table>
  <% end %>
</div>

<script>$('#searchResult').html($(".search_row").length)</script>